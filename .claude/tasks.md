# Nostalgic - 実装タスク

## 🚨 緊急タスク（動作確認・修正必要）

### 1. DDD化後の動作確認 🔥
- [ ] **Counter Service**: リファクタリング後の動作確認
  - [ ] 作成（create）
  - [ ] カウントアップ（increment）
  - [ ] 値設定（set）
  - [ ] 表示（display）- SVG、JSON、テキスト
  - [ ] 重複防止機能
  - [ ] 日別統計の正常動作
- [ ] **Like Service**: 初回動作確認
  - [ ] 作成（create）
  - [ ] いいね切り替え（toggle）
  - [ ] 状態取得（get）
  - [ ] ユーザー状態の24時間保持
- [ ] **Ranking Service**: 初回動作確認
  - [ ] 作成（create）
  - [ ] スコア送信（submit）
  - [ ] スコア更新（update）
  - [ ] エントリー削除（remove）
  - [ ] ランキング取得（get）
  - [ ] 全クリア（clear）
- [ ] **BBS Service**: 初回動作確認
  - [ ] 作成（create）
  - [ ] メッセージ投稿（post）
  - [ ] メッセージ編集（update）
  - [ ] メッセージ削除（remove）
  - [ ] メッセージ一覧（get）
  - [ ] ページネーション
  - [ ] カスタムドロップダウン・アイコン

### 2. デモページの仕様確認・改善 🔥
- [ ] 各サービスデモページのUIレビュー
  - [ ] ボタン操作での作成機能の是非
  - [ ] エラーハンドリングの改善
  - [ ] ユーザビリティの向上
- [ ] APIエンドポイントの正しいパス確認
  - [ ] `/api/visit` （旧 `/api/v2/counter`）
  - [ ] `/api/like` （実装必要）
  - [ ] `/api/ranking` （実装必要）
  - [ ] `/api/bbs` （実装必要）

### 3. ドキュメント更新 🔥
- [ ] **README.md**
  - [ ] DDD化後のプロジェクト構造説明
  - [ ] APIエンドポイントの更新（v2削除）
  - [ ] 削除されたファイルの参照削除
- [ ] **docs/API.md**
  - [ ] 新しいAPIパス反映
  - [ ] サンプルコードの更新
- [ ] **docs/services/**
  - [ ] 各サービスドキュメントの技術仕様更新
  - [ ] アーキテクチャ変更の反映

### 4. DDD設計ドキュメント作成 🔥
- [ ] `.claude/architecture.md` 作成
  - [ ] ドメイン駆動設計の概要
  - [ ] ディレクトリ構造説明
  - [ ] 各層の責務
  - [ ] Result型パターンの説明
  - [ ] Repository パターンの説明
  - [ ] BaseService の設計思想

## ✅ 完了済み（DDD化・型安全化）

### アーキテクチャ大規模リファクタリング ✅ 完了
- [x] **ドメイン駆動設計（DDD）への移行**
  - [x] `/src/domain/` 構造の実装
  - [x] Result型パターンの導入
  - [x] Repository パターンの実装
  - [x] BaseService 抽象クラスの実装
  - [x] 各ドメインサービスの実装（Counter, Like, Ranking, BBS）
- [x] **100%型安全性の達成**
  - [x] 全ての `: any` 型注釈を除去
  - [x] 全ての型アサーション（as）を最小限に
  - [x] Zod による完全な実行時型検証
- [x] **旧実装の完全削除**
  - [x] `/src/lib/services/` フォルダ削除
  - [x] 旧APIエンドポイント削除
  - [x] レガシーサポートコード削除

### Redis Show改善 ✅ 完了
- [x] 日別データの日付順ソート実装

## 📋 今後のタスク（優先度：中）

### Web Components の実装
- [ ] Like用Web Component (`/components/like.js`)
- [ ] Ranking用Web Component (`/components/ranking.js`)
- [ ] BBS用Web Component (`/components/bbs.js`)

### パフォーマンス最適化
- [ ] Redis接続プーリング
- [ ] キャッシュ戦略の見直し
- [ ] バッチ処理の最適化

### セキュリティ強化
- [ ] レート制限の実装
- [ ] 入力検証の強化
- [ ] CORS設定の最適化

## 📚 優先度：低

### テストの追加
- [ ] ユニットテスト（各ドメインサービス）
- [ ] 統合テスト（APIエンドポイント）
- [ ] E2Eテスト（デモページ）

### 監視・ロギング
- [ ] エラー監視システム
- [ ] パフォーマンス監視
- [ ] 使用量ダッシュボード

## 🎨 新サービスアイデア

### Rate Service（評価サービス）
- 1〜5段階の星評価システム
- 1人1つの評価値を保存・更新可能

## 🚫 実装しないサービス

### Rate Service（レートサービス）について
- 通常のLikeとは異なり、1人が星5評価をしても、2人目がクリックしても10にはならない
- 評価の平均値表示や入力フィールドの複雑性を考慮し、現時点では実装しない
- Likeサービスでのアイコン切り替え機能で代替する

## 🧑‍💻 人間系タスク

### プロジェクト環境設定
- [ ] **本番環境テスト**: DDD化後の全機能確認
- [ ] **パフォーマンス測定**: 旧実装との比較
- [ ] **エラー監視設定**: Vercelでのエラー追跡

## 📝 技術的負債と改善点

### 発見された問題
- URL mappingのデータ不整合（ダブルクォーテーション有無）
- `counter:` プレフィックス付きURLキーの存在
- 異なる時期の実装による型の違い

### 今後の課題
- APIのバージョニング戦略
- マイグレーション戦略
- データ整合性チェックツール

## 🎯 現在の状態

### 完了
- DDD アーキテクチャへの完全移行
- 100% 型安全性の達成
- 旧実装の完全削除
- Result型によるエラーハンドリング統一

### 未確認・要対応
- **全サービスの動作確認が未実施**
- **ドキュメントが古い状態**
- **デモページの仕様レビューが必要**
- **DDD設計ドキュメントが未作成**

### 次のステップ
1. 各サービスの動作確認（最優先）
2. APIエンドポイントの実装確認
3. ドキュメントの更新
4. 設計ドキュメントの作成